{# liste des sessions  #}
{% extends 'base.html.twig' %}

{% block title %}Liste des sessions{% endblock %}

{% block body %}

<section id="sessions">
  <h2>Liste des sessions de formation</h2>
  <table class="table table-striped">
      <thead>
        <tr class="table-danger">
          <th scope="col">Formation</th>
          <th scope="col">Début</th>
          <th scope="col">Fin</th>
          <th scope="col">Places totales</th>
          <th scope="col">Places prises</th>
          <th scope="col">Places restantes</th>
        </tr>
      </thead>
      <tbody>
  {% for session in sessions %}
    {% if session.ouvert == true %}
      <tr>
        {% set lock = "" %}
    {% else %}
      <tr class="table-secondary">
        {% set lock = "(verrouillé)" %}
    {% endif %}
          
              <td><a href="{{ path('show_session', {'id': session.id}) }}" class="section-detail">{{session}}</a> {{lock}}</td>
              <td>{{ session.dateDebut | date("d.m.Y") }}</td>
              <td>{{ session.dateFin | date("d.m.Y") }}</td>
              <td>{{ session.nbPlace }}</td>
              <td>{{session.nbInscription}}</td>
              <td>{{session.nbDispo}}
                {# si connecté, admin ou personne qui a créée la session #}
                {% if app.user %}
                  {% if "ROLE_ADMIN" in app.user.roles or app.user == session.user %}
                    <a href="{{ path('edit_session', {'id': session.id}) }}"><i class="fa-solid fa-pen"></i></a>
                  {% endif %}
                {% endif %}
              </td>
          </tr>
  {% endfor %}
      </tbody>
  </table>
  {% if app.user %}
    <a href="{{ path('new_session') }}" class="add-btn"><button>Créer session</button></a>
    
  {% endif %}
</section>


{% endblock %}
